<!DOCTYPE html>
<html lang="en" class="dark">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>SA Early Voting Tracker</title>
        <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
        <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
        <style>
            /* ... (previous styles remain the same up to radio buttons) ... */
            body {
                background: linear-gradient(to bottom, #0f172a 0%, #111827 100%);
                color: #f3f4f6;
                min-height: 100vh;
            }
            .card {
                background-color: #1f2937;
                border-radius: 0.75rem;
                box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.2);
                padding: 1.75rem;
                border: 1px solid #374151;
                transition: box-shadow 0.2s ease;
            }
            .card:hover {
                box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3), 0 10px 10px -5px rgba(0, 0, 0, 0.2);
            }
            .form-input-style, .form-multiselect-style {
                margin-top: 0.25rem;
                display: block;
                width: 100%;
                padding: 0.625rem 0.875rem;
                border-radius: 0.5rem;
                border: 1px solid #4b5563;
                background: linear-gradient(to bottom, #374151 0%, #2d3748 100%);
                color: #e5e7eb;
                box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2);
                transition: all 0.2s;
                font-size: 0.9375rem;
            }
            .form-input-style:focus, .form-multiselect-style:focus {
                border-color: #db2777;
                outline: none;
                box-shadow: 0 0 0 3px rgba(236, 72, 153, 0.3), inset 0 2px 4px rgba(0, 0, 0, 0.2);
                background: linear-gradient(to bottom, #434e5e 0%, #374151 100%);
            }
            .form-input-style::placeholder {
                color: #9ca3af;
            }
            .button-pink {
                display: inline-block;
                padding: 0.875rem 1.5rem;
                background: linear-gradient(to bottom, #ec4899 0%, #db2777 100%);
                color: #ffffff;
                font-weight: 600;
                border-radius: 0.5rem;
                text-align: center;
                transition: all 0.2s;
                text-decoration: none;
                border: 1px solid #f472b6;
                cursor: pointer;
                box-shadow: 0 4px 6px rgba(219, 39, 119, 0.3);
                font-size: 0.9375rem;
            }
            .button-pink:hover {
                background: linear-gradient(to bottom, #f472b6 0%, #ec4899 100%);
                transform: translateY(-2px);
                box-shadow: 0 6px 12px rgba(219, 39, 119, 0.4);
            }
            .button-pink:active {
                transform: translateY(0);
                box-shadow: 0 2px 4px rgba(219, 39, 119, 0.3);
            }
            .button-secondary {
                display: inline-flex;
                align-items: center;
                justify-content: center;
                padding: 0.75rem 1.5rem;
                background-color: #374151;
                color: #e5e7eb;
                font-weight: 600;
                border-radius: 0.5rem;
                text-align: center;
                transition: all 0.2s;
                text-decoration: none;
                border: 1px solid #4b5563;
                cursor: pointer;
                font-size: 0.875rem;
            }
            .button-secondary:hover {
                background-color: #4b5563;
                border-color: #6b7280;
                color: #ffffff;
                transform: translateY(-1px);
                box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3);
            }
            .button-secondary:active {
                transform: translateY(0);
            }
            
            /* Preset buttons */
            .preset-button {
                display: flex;
                align-items: center;
                justify-content: center;
                width: 100%;
                padding: 0.75rem 1.125rem;
                background: linear-gradient(to bottom, #374151 0%, #2d3748 100%);
                color: #d1d5db;
                border: 1px solid #4b5563;
                border-radius: 0.5rem;
                font-size: 0.875rem;
                font-weight: 500;
                cursor: pointer;
                transition: all 0.2s;
                white-space: normal;
                text-align: center;
                line-height: 1.4;
                min-height: 3.125rem;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            }
            .preset-button:hover {
                background: linear-gradient(to bottom, #4b5563 0%, #374151 100%);
                border-color: #db2777;
                color: #f9fafb;
                transform: translateY(-1px);
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            }
            .preset-button:active {
                transform: translateY(0);
                box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
            }
            
            .data-table-container {
                margin-top: 0;
                max-height: 40rem;
                overflow: auto;
                border-radius: 0.5rem;
            }
            
            .data-table-container::-webkit-scrollbar {
                width: 10px;
                height: 10px;
            }
            
            .data-table-container::-webkit-scrollbar-track {
                background: #1f2937;
                border-radius: 5px;
            }
            
            .data-table-container::-webkit-scrollbar-thumb {
                background: #4b5563;
                border-radius: 5px;
            }
            
            .data-table-container::-webkit-scrollbar-thumb:hover {
                background: #6b7280;
            }
            
            .data-table {
                width: 100%;
                font-size: 0.875rem;
                text-align: left;
                border-collapse: separate;
                border-spacing: 0;
            }
            .data-table th, .data-table td {
                padding: 0.875rem 1.125rem;
                border-bottom: 1px solid #374151;
            }
            .data-table th {
                background: linear-gradient(to bottom, #374151 0%, #2d3748 100%);
                font-weight: 700;
                position: sticky;
                top: 0;
                z-index: 10;
                text-transform: uppercase;
                font-size: 0.75rem;
                letter-spacing: 0.05em;
                color: #f472b6;
                border-bottom: 2px solid #db2777;
            }
            .data-table tbody tr {
                transition: all 0.2s;
            }
            .data-table tbody tr:hover {
                background-color: #374151;
                transform: scale(1.002);
            }
            .hidden {
                display: none !important;
            }

            .space-y-3 > * + * {
                margin-top: 0.875rem;
            }
            
            /* Checkbox styling improvements */
            .form-checkbox {
                width: 1.125rem;
                height: 1.125rem;
                border-radius: 0.375rem;
                border: 2px solid #4b5563;
                background-color: #374151;
                cursor: pointer;
                transition: all 0.2s;
            }
            
            .form-checkbox:checked {
                background-color: #db2777;
                border-color: #ec4899;
                box-shadow: 0 0 0 3px rgba(236, 72, 153, 0.2);
            }
            
            .form-checkbox:focus {
                outline: none;
                box-shadow: 0 0 0 3px rgba(236, 72, 153, 0.3);
            }
            
            .inline-flex {
                display: inline-flex;
            }
            
            .items-center {
                align-items: center;
            }
            
            label.inline-flex {
                cursor: pointer;
                user-select: none;
                transition: color 0.2s;
            }
            
            label.inline-flex:hover {
                color: #f3f4f6;
            }
            
            label.inline-flex .ml-2 {
                margin-left: 0.625rem;
            }

            .top-controls-grid {
                display: grid;
                gap: 1.5rem;
                margin-bottom: 2rem;
            }

            @media (min-width: 1024px) {
                .top-controls-grid {
                    grid-template-columns: 1fr 360px;
                    gap: 2rem;
                }
            }

            .bottom-controls {
                margin-top: 2rem;
            }

            /* Currently viewing section removed for cleaner UX */

            .chart-card {
                position: relative;
                background: linear-gradient(to bottom, #1f2937 0%, #1a2332 100%);
            }
            
            .chart-canvas-wrapper {
                position: relative;
                width: 100%;
                height: 500px;
            }

            .chart-card canvas {
                width: 100% !important;
                height: 100% !important;
                max-height: 500px;
            }
            
            #cat-container {
                position: absolute;
                inset: 0;
            }
            
            @media (min-width: 768px) {
                .chart-canvas-wrapper {
                    height: 600px;
                }
                .chart-card canvas {
                    max-height: 600px;
                }
            }

            .data-table-card {
                grid-area: table;
                background: linear-gradient(to bottom, #1f2937 0%, #1a2332 100%);
            }

            .visualization-grid {
                display: grid;
                gap: 2rem;
            }

            .controls-card {
                position: relative;
            }

            .control-section {
                display: flex;
                flex-direction: column;
                gap: 1rem;
            }

            .control-section + .control-section {
                border-top: 1px solid #374151;
                padding-top: 1.5rem;
                margin-top: 1.5rem;
            }
            
            .bottom-controls .controls-grid {
                display: grid;
                gap: 1.75rem;
            }
            
            .bottom-controls .controls-grid > .control-section {
                border-top: 1px solid #374151;
                padding-top: 1.5rem;
                margin-top: 1.5rem;
            }
            
            .bottom-controls .controls-grid > .control-section:first-child {
                border-top: none;
                padding-top: 0;
                margin-top: 0;
            }
            
            @media (min-width: 768px) {
                .bottom-controls .controls-grid {
                    grid-template-columns: minmax(0, 1.35fr) minmax(0, 1fr);
                    align-items: start;
                }
                
                .bottom-controls .controls-grid > .control-section {
                    border-top: none;
                    padding-top: 0;
                    margin-top: 0;
                }
                
                .control-section--years {
                    grid-row: 1 / span 2;
                }
                
                .control-section--data,
                .control-section--chart {
                    grid-column: 2;
                }
                
                .control-section--locations {
                    grid-column: 1 / -1;
                }
            }
            
            @media (min-width: 1280px) {
                .bottom-controls .controls-grid {
                    grid-template-columns: minmax(0, 1.5fr) minmax(0, 1fr) minmax(0, 1.4fr);
                    grid-template-areas:
                        "years toggles locations"
                        "years chart locations";
                }
                
                .control-section--years {
                    grid-area: years;
                }
                
                .control-section--data {
                    grid-area: toggles;
                }
                
                .control-section--chart {
                    grid-area: chart;
                }
                
                .control-section--locations {
                    grid-area: locations;
                }
            }

            .control-section-title {
                font-size: 0.75rem;
                letter-spacing: 0.1em;
                text-transform: uppercase;
                color: #f472b6;
                font-weight: 700;
                margin-bottom: 0.25rem;
            }

            /* Quick Presets responsive grid */
            .presets-grid {
                display: grid;
                width: 100%;
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }

            .control-section-note {
                font-size: 0.875rem;
                color: #9ca3af;
                margin: 0 0 0.5rem 0;
                line-height: 1.5;
            }


            
            .year-checkbox-container {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
                gap: 0.625rem;
                padding: 1rem;
                background: linear-gradient(to bottom, #374151 0%, #2d3748 100%);
                border-radius: 0.75rem;
                border: 1px solid #4b5563;
                box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2);
            }
            
            .year-checkbox-container label {
                display: flex !important;
                align-items: center;
                justify-content: center;
                padding: 0.75rem 0.875rem;
                background-color: #1f2937;
                border: 2px solid #4b5563;
                border-radius: 0.5rem;
                cursor: pointer;
                transition: all 0.2s;
                user-select: none;
                font-size: 0.875rem;
                font-weight: 600;
                text-align: center;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            }
            
            .year-checkbox-container label:hover {
                border-color: #db2777;
                background-color: #374151;
                transform: translateY(-1px);
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            }
            
            .year-checkbox-container input[type="checkbox"] {
                display: none;
            }
            
            .year-checkbox-container label.checked {
                background: linear-gradient(to bottom, #ec4899 0%, #db2777 100%);
                border-color: #f472b6;
                color: white;
                box-shadow: 0 4px 6px rgba(219, 39, 119, 0.4);
            }
            
            .year-checkbox-container label.checked:hover {
                transform: translateY(-1px);
                box-shadow: 0 6px 8px rgba(219, 39, 119, 0.5);
            }
            
            .location-checkbox-container {
                max-height: 22rem;
                overflow-y: auto;
                border: 1px solid #4b5563;
                border-radius: 0.75rem;
                padding: 0.625rem;
                background: linear-gradient(to bottom, #374151 0%, #2d3748 100%);
                box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2);
            }
            
            /* Scrollbar styling */
            .location-checkbox-container::-webkit-scrollbar {
                width: 8px;
            }
            
            .location-checkbox-container::-webkit-scrollbar-track {
                background: #1f2937;
                border-radius: 4px;
            }
            
            .location-checkbox-container::-webkit-scrollbar-thumb {
                background: #4b5563;
                border-radius: 4px;
            }
            
            .location-checkbox-container::-webkit-scrollbar-thumb:hover {
                background: #6b7280;
            }
            
            .location-checkbox-container .location-option {
                display: flex;
                align-items: center;
                padding: 0.75rem 0.875rem;
                margin: 0.25rem 0;
                border-radius: 0.5rem;
                cursor: pointer;
                transition: all 0.2s;
                background-color: rgba(31, 41, 55, 0.5);
            }
            
            .location-checkbox-container .location-option:hover {
                background-color: #1f2937;
                transform: translateX(2px);
            }
            
            .location-checkbox-container .location-option input[type="checkbox"] {
                margin-right: 0.875rem;
                accent-color: #db2777;
                width: 1.125rem;
                height: 1.125rem;
                cursor: pointer;
                border-radius: 0.25rem;
            }

            .location-checkbox-container .location-option label {
                cursor: pointer;
                flex: 1;
                font-size: 0.9375rem;
                line-height: 1.4;
            }

            /* Radio button group styling - REVISED */
            .radio-group-label {
                display: block;
                font-size: 0.875rem;
                font-weight: 600;
                margin-bottom: 0.5rem;
                color: #e5e7eb;
            }
            .radio-button-group {
                display: flex;
                border-radius: 0.5rem;
                overflow: hidden;
                border: 1px solid #4b5563;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
                background: linear-gradient(to bottom, #374151 0%, #2d3748 100%);
            }
            .radio-button-group label {
                flex-grow: 1;
                background-color: transparent;
                cursor: pointer;
                transition: all 0.2s;
            }
            .radio-button-group label:not(:last-child) {
                border-right: 1px solid #4b5563;
            }
            .radio-button-group input[type="radio"] {
                display: none;
            }
            .radio-button-group label span {
                display: block;
                text-align: center;
                padding: 0.625rem 0.875rem;
                color: #d1d5db;
                font-size: 0.875rem;
                font-weight: 500;
                width: 100%;
                height: 100%;
                box-sizing: border-box;
                transition: all 0.2s;
            }
            .radio-button-group label:hover span:not(.radio-selected) {
                background-color: rgba(75, 85, 99, 0.5);
                color: #f3f4f6;
            }
            .radio-button-group label span.radio-selected {
                background: linear-gradient(to bottom, #ec4899 0%, #db2777 100%);
                color: white;
                font-weight: 600;
                box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2);
            }
            


            @media (max-width: 768px) {
                .card {
                    padding: 1.25rem;
                }
                .year-checkbox-container {
                    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
                    gap: 0.5rem;
                    padding: 0.875rem;
                }
                .year-checkbox-container label {
                    padding: 0.625rem 0.75rem;
                    font-size: 0.8125rem;
                }
                .header-buttons {
                    flex-direction: column;
                    align-items: stretch;
                    gap: 0.625rem;
                }
                .header-buttons .button-secondary {
                    width: 100%;
                    padding: 0.75rem 1.25rem;
                }
                .chart-canvas-wrapper {
                    height: 400px;
                }
                .chart-card canvas {
                    max-height: 400px;
                }
                .control-section {
                    gap: 0.875rem;
                }
                .dashboard-grid {
                    gap: 1.5rem;
                }
                .sidebar-stack {
                    gap: 1.5rem;
                }
            }
            
            h2, label, span, p, option, th, td {
                color: #d1d5db;
            }
            p.text-sm, p.text-xs {
                color: #9ca3af;
            }
            
            .text-xs {
                font-size: 0.75rem;
                line-height: 1.4;
            }
            
            h3 {
                color: #f9fafb;
            }
            
            /* Resources card styling */
            .card h3 {
                font-size: 1.125rem;
                font-weight: 700;
                letter-spacing: -0.025em;
            }
            
            .grid.gap-3 {
                gap: 0.875rem;
            }
            
            /* Helper text styling */
            .mb-2 {
                margin-bottom: 0.5rem;
            }
            
            .mb-3 {
                margin-bottom: 0.75rem;
            }
            
            .mb-4 {
                margin-bottom: 1rem;
            }
            
            .leading-relaxed {
                line-height: 1.625;
            }
            
            .flex-1 {
                flex: 1 1 0%;
            }
            
            .text-sm {
                font-size: 0.875rem;
            }
            
            .py-2 {
                padding-top: 0.5rem;
                padding-bottom: 0.5rem;
            }


        </style>
    </head>
    <body>
        <div class="min-h-screen" style="background: linear-gradient(to bottom, #0f172a 0%, #111827 100%);">
            <div class="container mx-auto px-4 py-6">
                <!-- Top section: Chart and side controls -->
                <div class="top-controls-grid">
                    <div id="chart-container" class="chart-card card">
                        <div class="chart-canvas-wrapper">
                            <canvas id="turnoutChart"></canvas>
                        </div>
                    </div>

                    <div class="card controls-card">
                        <section class="control-section">
                            <h3 class="control-section-title">Quick Presets</h3>
                            <div id="preset-buttons-container" class="presets-grid">
                                <!-- Preset buttons populated by JS -->
                            </div>
                        </section>

                        <section class="control-section">
                            <h3 class="control-section-title">Voter Resources</h3>
                            <div class="grid grid-cols-1 gap-2">
                                <a href="https://rosematcha.com/sampleballot/" target="_blank" rel="noopener noreferrer" class="button-pink text-center text-sm py-2">Sample Ballot</a>
                                <a href="https://goelect.txelections.civixapps.com/ivis-mvp-ui/#/login" target="_blank" rel="noopener noreferrer" class="button-pink text-center text-sm py-2">Check Registration</a>
                                <a href="https://www.bexar.org/1568/Elections-Department" target="_blank" rel="noopener noreferrer" class="button-pink text-center text-sm py-2">County Info</a>
                                <a href="https://s3.amazonaws.com/ClubExpressClubFiles/571900/documents/2025_Nov_Voters_Guide_English_online_449834538.pdf?AWSAccessKeyId=AKIA6MYUE6DNNJ6ROIH3&Expires=1760552045&response-content-disposition=inline%3B%20filename%3D2025_Nov_Voters_Guide_English_online.pdf&Signature=hzBXSqPDsSiIv63fbcAURWpWyJg%3D" target="_blank" rel="noopener noreferrer" class="button-pink text-center text-sm py-2">LWVSA Voter Guide</a>
                            </div>
                        </section>

                        <section class="control-section">
                            <div class="flex gap-2">
                                <button id="reset-view-button" class="button-secondary flex-1">Reset View</button>
                                <button id="copy-share-link-button" class="button-secondary flex-1">Copy Link</button>
                            </div>
                        </section>
                    </div>
                </div>

                <!-- Bottom section: Additional controls -->
                <div class="bottom-controls">
                    <div class="card controls-card">
                        <div class="controls-grid">
                            <section class="control-section control-section--years">
                            <h3 class="control-section-title">Election Years</h3>
                            <p class="control-section-note">Select one or more elections to compare turnout trends. Each color represents a different year.</p>
                            <div id="year-options" class="year-checkbox-container">
                                <!-- Year checkboxes populated by JS -->
                            </div>
                        </section>

                            <section class="control-section control-section--data">
                                <h3 class="control-section-title">Data Shown</h3>
                                <p class="control-section-note">Toggle which voting periods appear on the chart.</p>
                                <div class="space-y-3">
                                    <label class="inline-flex items-center">
                                        <input id="early-voting-toggle" type="checkbox" class="form-checkbox rounded text-pink-600 focus:ring-pink-500" checked />
                                        <span class="ml-2 text-sm text-gray-300">Early Voting Period</span>
                                    </label>
                                    <label class="inline-flex items-center">
                                        <input id="election-day-toggle" type="checkbox" class="form-checkbox rounded text-pink-600 focus:ring-pink-500" checked />
                                        <span class="ml-2 text-sm text-gray-300">Election Day Final Count</span>
                                    </label>
                                </div>
                            </section>

                            <section class="control-section control-section--chart">
                                <h3 class="control-section-title">Chart Options</h3>
                                <div class="space-y-3">
                                    <div>
                                        <label class="radio-group-label text-gray-300">View Mode</label>
                                        <p class="text-xs text-gray-400 mb-2">Per-day shows daily totals. Cumulative shows running totals.</p>
                                        <div class="radio-button-group">
                                            <label>
                                                <input type="radio" name="data-presentation" value="per-day" checked>
                                                <span>Per-Day</span>
                                            </label>
                                            <label>
                                                <input type="radio" name="data-presentation" value="cumulative">
                                                <span>Cumulative</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div>
                                        <label class="radio-group-label text-gray-300">Format</label>
                                        <div class="radio-button-group">
                                            <label>
                                                <input type="radio" name="display-as" value="graph" checked>
                                                <span>Chart</span>
                                            </label>
                                            <label>
                                                <input type="radio" name="display-as" value="table">
                                                <span>Table</span>
                                            </label>
                                        </div>
                                    </div>
                                    <label class="inline-flex items-center">
                                        <input id="y-axis-toggle" type="checkbox" class="form-checkbox rounded text-pink-600 focus:ring-pink-500" checked />
                                        <span class="ml-2 text-sm text-gray-300">Start Y-Axis at Zero</span>
                                    </label>
                                </div>
                            </section>

                            <section class="control-section control-section--locations">
                                <h3 class="control-section-title">Locations</h3>
                                <p class="control-section-note">Compare specific voting centers or view county-wide totals. Select "Total Turnout" for overall trends.</p>
                                
                                <div id="location-controls" class="space-y-3">
                                    <div>
                                        <label for="location-filter" class="block text-sm font-medium mb-2 text-gray-300">
                                            Filter by Name
                                        </label>
                                        <input
                                            type="text"
                                            id="location-filter"
                                            placeholder="Search voting locations..."
                                            class="form-input-style mb-2"
                                        />
                                        <div class="flex gap-2 flex-wrap">
                                            <button id="select-all-locations" class="text-xs text-pink-400 hover:text-pink-300 underline">Select All</button>
                                            <span class="text-xs text-gray-600">|</span>
                                            <button id="deselect-all-locations" class="text-xs text-pink-400 hover:text-pink-300 underline">Clear All</button>
                                        </div>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium mb-2 text-gray-300">Available Locations</label>
                                        <div id="location-checkbox-container" class="location-checkbox-container">
                                            <!-- Location checkboxes populated by JS -->
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </div>
                    </div>

                    <!-- Data table -->
                    <div id="data-table-container" class="data-table-container card data-table-card hidden" style="margin-top: 2rem;">
                        <!-- Data table populated by JS -->
                    </div>

                    <!-- Attribution -->
                    <p id="attribution" class="text-sm text-gray-400" style="margin-top: 2rem; padding-top: 2rem; border-top: 1px solid #374151; text-align: center;">
                        Data sourced from the Bexar County Elections Department via Public Information Act request. Updated as of October 15, 2025.
                    </p>
                </div>
            </div>

        <!-- Radio button visual state handled by ui.js -->

        <script type="module" src="js/main.js"></script>
    </body>
</html>
