<!DOCTYPE html>
<html lang="en" class="dark"> <!-- Always dark mode -->
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>SA Early Voting Tracker</title>
        <!-- Tailwind CSS CDN -->
        <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
        <!-- Chart.js CDN -->
        <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
        <style type="text/tailwindcss">
            /* Base styles for dark mode ONLY */
            body {
                @apply bg-gray-900 text-gray-100; /* Dark background, light text */
            }
            /* Reusable card component style */
            .card {
                @apply bg-gray-800 rounded shadow p-4; /* Dark card background */
            }
            /* Consistent input styling for dark mode */
            .form-input-style, .form-multiselect-style {
                 @apply mt-1 block w-full rounded-md border-gray-600 bg-gray-700 text-gray-200 shadow-sm focus:border-pink-400 focus:ring focus:ring-pink-300 focus:ring-opacity-50;
            }
            /* Pink accent button */
            .button-pink {
                 @apply inline-block px-4 py-2 bg-pink-600 text-white font-semibold rounded hover:bg-pink-700 focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-offset-2 focus:ring-offset-gray-900 text-center transition-colors duration-300;
            }
            /* Secondary button style */
             .button-secondary {
                 @apply inline-block px-4 py-2 bg-gray-600 text-white font-semibold rounded hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-900 text-center transition-colors duration-300;
            }
            /* Ensure specific text elements are light */
            h2, label, span, p, option, th, td { /* Added th, td */
                @apply text-gray-200; /* Default light text */
            }
             p.text-sm, p.text-xs { /* Dimmer text for notes */
                 @apply text-gray-400;
             }
             /* Style selected options in multi-select */
             select[multiple] option:checked {
                 @apply bg-pink-600 bg-opacity-50 text-white;
             }
            /* Data Table Styles */
            .data-table-container {
                @apply card mt-6 max-h-[36rem] overflow-auto; /* Max height and scroll */
            }
            .data-table {
                @apply w-full text-sm text-left;
            }
            .data-table th, .data-table td {
                @apply px-4 py-2 border-b border-gray-700;
            }
            .data-table th {
                @apply bg-gray-750 font-semibold; /* Slightly different bg for header */
            }
            .data-table tbody tr:hover {
                @apply bg-gray-700;
            }
            .hidden {
                display: none;
            }
        </style>
    </head>
    <body class="font-sans">
        <div class="container mx-auto p-4 md:p-8">
            <!-- Header Area -->
            <div class="flex justify-between items-start mb-6">
                <img
                    src="title.gif"
                    alt="San Antonio Early Voting Turnout"
                    width="895"
                    height="92"
                    class="max-w-[70%] md:max-w-md h-auto"
                />
            </div>

            <!-- Chart/Table Area -->
            <div id="visualization-area" class="relative mb-6">
                <div id="chart-container" class="relative card h-96 md:h-[36rem]">
                    <!-- Status message inserted here by JS -->
                    <canvas id="turnoutChart"></canvas>
                    <!-- Cat container added here by JS if needed -->
                </div>
                <div id="data-table-container" class="data-table-container hidden">
                    <!-- Data table populated by JS -->
                </div>
            </div>


            <!-- Action Buttons -->
            <div
                class="flex flex-col sm:flex-row flex-wrap sm:space-x-4 space-y-2 sm:space-y-0 mb-6"
            >
                <a
                    href="https://www.bexar.org/2231/Who-represents-me-Search"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="button-pink mb-2 sm:mb-0"
                >
                    See Your Sample Ballot
                </a>
                <a
                    href="https://www.bexar.org/2229/Voter-Registration-Check-Polling-Locatio"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="button-pink mb-2 sm:mb-0"
                >
                    Verify Voter Registration
                </a>
                 <button id="copy-share-link-button" class="button-pink mb-2 sm:mb-0">
                    Copy Share Link
                </button>
                <a
                    href="https://lwvsa.org/handlers/celinks.ashx?id=74871"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="button-secondary mb-2 sm:mb-0"
                >
                    League of Women Voters Voter Guide
                </a>
            </div>

            <!-- Controls Area -->
            <div class="mb-6 card">
                <h2 class="text-xl font-semibold mb-3">Display Options</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">

                    <!-- Year Selection -->
                    <div class="md:col-span-1">
                        <label for="year-options" class="block text-sm font-medium mb-1">
                            Select Years:
                        </label>
                        <div id="year-options" class="space-y-1 max-h-32 overflow-y-auto border border-gray-600 rounded p-2 bg-gray-700">
                            <!-- Year checkboxes populated by JS -->
                        </div>
                        <p class="text-xs text-gray-400 mt-1">
                            other years pending public info request
                        </p>
                    </div>

                    <!-- Location Selection (Checkbox List) -->
                    <div class="md:col-span-1">
                        <label for="location-filter" class="block text-sm font-medium mb-1">
                            Select Locations/Total:
                        </label>
                        <!-- Filter Input -->
                        <input
                            type="text"
                            id="location-filter"
                            placeholder="Filter locations..."
                            class="form-input-style mb-2 text-sm py-1"
                        />
                        <!-- Select/Deselect Buttons -->
                        <div class="flex justify-between items-center mb-1 px-1">
                            <button id="select-all-locations" class="text-xs text-pink-400 hover:text-pink-300 focus:outline-none">Select All</button>
                            <button id="deselect-all-locations" class="text-xs text-pink-400 hover:text-pink-300 focus:outline-none">Deselect All</button>
                        </div>
                        <!-- Checkbox Container -->
                        <div id="location-checkbox-container" class="space-y-1 max-h-40 overflow-y-auto border border-gray-600 rounded p-2 bg-gray-700">
                            <!-- Checkboxes populated by JS -->
                        </div>
                    </div>

                    <!-- Data & Axis Toggles -->
                    <div class="md:col-span-1 space-y-3">
                         <div>
                             <label class="block text-sm font-medium mb-1">
                                 Show Data Types:
                             </label>
                             <label class="inline-flex items-center">
                                 <input
                                     id="early-voting-toggle"
                                     type="checkbox"
                                     class="form-checkbox rounded text-pink-600 focus:ring-pink-500"
                                     checked
                                 />
                                 <span class="ml-2 text-sm">Early Voting</span>
                             </label>
                             <label class="inline-flex items-center ml-4">
                                 <input
                                     id="election-day-toggle"
                                     type="checkbox"
                                     class="form-checkbox rounded text-pink-600 focus:ring-pink-500"
                                     checked
                                 />
                                 <span class="ml-2 text-sm">Election Day</span>
                             </label>
                         </div>
                         <div>
                             <label class="block text-sm font-medium mb-1">
                                 Chart Options:
                             </label>
                             <label class="inline-flex items-center">
                                 <input
                                     id="y-axis-toggle"
                                     type="checkbox"
                                     class="form-checkbox rounded text-pink-600 focus:ring-pink-500"
                                     checked
                                 />
                                 <span class="ml-2 text-sm">Start Y-Axis at Zero</span>
                             </label>
                             <label class="inline-flex items-center ml-4"> <!-- New Toggle for Data Table -->
                                 <input
                                     id="data-table-toggle"
                                     type="checkbox"
                                     class="form-checkbox rounded text-pink-600 focus:ring-pink-500"
                                 />
                                 <span class="ml-2 text-sm">Show Data Table</span>
                             </label>
                         </div>
                    </div>
                </div>
            </div>

            <!-- Data Source Attribution -->
            <p id="attribution" class="text-sm mb-6">
                Data sourced from the Bexar County Elections Department.
                <!-- Update date dynamically -->
            </p>

        </div>

        <!-- Load JS Modules -->
        <script type="module" src="js/main.js"></script>
    </body>
</html>